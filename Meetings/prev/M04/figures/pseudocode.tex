\documentclass{article}
\usepackage{graphicx}
\usepackage{enumitem}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{caption}
\usepackage{amsthm}
\usepackage[margin=2cm]{geometry}

\pagestyle{empty}
\setlist{nosep}
\algnewcommand\algorithmicforeach{\textbf{for each}}
\algdef{S}[FOR]{ForEach}[1]{\algorithmicforeach\ #1\ \algorithmicdo}
\algnewcommand\algorithmicswitch{\textbf{switch}}
\algnewcommand\algorithmiccase{\textbf{case}}
\algdef{SE}[SWITCH]{Switch}{EndSwitch}[1]{\algorithmicswitch\ #1\ \algorithmicdo}{\algorithmicend\ \algorithmicswitch}%
\algdef{SE}[CASE]{Case}{EndCase}[1]{\algorithmiccase\ #1}{\algorithmicend\ \algorithmiccase}%
\algtext*{EndSwitch}%
\algtext*{EndCase}%
\newtheorem*{lemma}{Lemma}

\begin{document}
    \section*{Algorithms}
    \begin{algorithm} \caption{\textsc{findPairs} algorithm}
        \textbf{Require:} a dataset of points $\mathcal P$, a number of partitions $p$ and a distance threshold $\varepsilon$.
        \begin{algorithmic}[1]
        \Function{ findPairs }{ $\mathcal P$, $p$, $\varepsilon$}
            \State Partition $\mathcal P$ using a Quadtree and $p$ partitions \Comment{Using Algorithm 1 in next page.}
            \State Create a circle of radius $\varepsilon$ for each point in $\mathcal P$ and store them in $\mathcal Q$ \Comment{keep same id}
            \State Partition $\mathcal Q$ using the same partitioner of $\mathcal P$
            \State Build local index in $\mathcal P$ \Comment{Using operations provided by GeoSpark}
            \State Execute a distance join query in $\mathcal P$ and $\mathcal Q$ using $\varepsilon$ as distance \Comment{Using Algorithm 4 in following pages.}
            \State Filter those pairs where $p_1.id < p_2.id$
        \EndFunction
        \end{algorithmic}
    \end{algorithm}
\end{document}
